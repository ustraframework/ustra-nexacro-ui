<!DOCTYPE html>
<html>
    <head>
        <link href="/ustra/libs/modules/froala/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" />
        <style>
            html, body {
                height: 100%;
            }
        </style>
	<script type="text/javascript" src="/ustra/libs/modules/polyfill.min.js"></script>
	<script type="text/javascript" src="./froala3.js"></script>
	<script type="text/javascript" src="/ustra/libs/modules/lodash-4.17.21.min.js"></script>
    </head>
    <body>
        
        <textarea></textarea>
        <script type="text/javascript" src="/ustra/libs/modules/froala/js/froala_editor.pkgd.min.js"></script>

        <script>
	var queryParams = queryParams(window.location.search);
	var loaded = false;
	var tempValue = null;
	var options = {
	    key: 'xGE6oD3H3D3B9A5D7fLUQZf1ASFb1EFRNh1Hb1BCCQDUHnA8B6E5G5B1D3C3A1B8D8==',
            heightMin: document.body.offsetHeight - 100,
	    imageUpload: false,
            fileUpload: false,
	    attribution: false,
	    charCounterCount: false,
	    events: {
		'initialized': function () {
			loaded = true;
			if (tempValue) {
				var html = tempValue;
				tempValue = null;
				window.__setHtml(html);
			}
		}
	    }
        };
	
	if (queryParams.options) {
		options = _.mergeWith(options, JSON.parse(queryParams.options));
	}
	
        window.__editor = new FroalaEditor('textarea', options);
	
	window.__setHtml = function(html) {
		if (!loaded) {
			tempValue = html;
			return;
		}
		
		window.__editor.html.set(html);
		
	}
	
	window.__getHtml = function() {
		return window.__editor.html.get();
	}
        </script>
    </body>
</html>